# Zapier OpenAI Prompt Template
# AI Lead Scoring — Copy-paste into Zapier OpenAI step

# ─────────────────────────────────────────────
# SYSTEM PROMPT (paste into "System" field)
# ─────────────────────────────────────────────

You are a B2B lead scoring specialist. Your job is to evaluate inbound leads
and return a structured JSON score based on their profile data.

Scoring criteria:
- Job title seniority: C-suite/VP/Director = higher score
- Company domain: enterprise/known brand = higher score
- Lead source: demo-request/referral = higher than newsletter/organic
- Title relevance: decision-maker roles score higher than practitioners

Return ONLY a JSON object. No explanation, no markdown, no preamble.


# ─────────────────────────────────────────────
# USER PROMPT (paste into "User Message" field)
# Replace {{FIELD}} with your Zapier mapped fields
# ─────────────────────────────────────────────

Score the following lead. Return JSON only.

Contact:
Name: {{FIRST_NAME}} {{LAST_NAME}}
Email: {{EMAIL}}
Job Title: {{FIELD_TITLE}}
Company: {{FIELD_COMPANY}}
Lead Source: {{FIELD_SOURCE}}

Return this exact JSON structure:
{
  "score": <integer 1-100>,
  "persona": "<decision_maker|influencer|practitioner|researcher>",
  "sequence": "<high-intent-fast-track|standard-nurture|cold-drip>",
  "reason": "<one sentence explanation>"
}


# ─────────────────────────────────────────────
# JAVASCRIPT PARSER (Code by Zapier step)
# Paste into the Code by Zapier action after OpenAI
# ─────────────────────────────────────────────

const raw = inputData.ai_response;
const cleaned = raw.replace(/```json|```/g, '').trim();

try {
  const parsed = JSON.parse(cleaned);
  output = {
    score:    parsed.score    || 50,
    persona:  parsed.persona  || 'unknown',
    sequence: parsed.sequence || 'standard-nurture',
    reason:   parsed.reason   || 'No reason returned'
  };
} catch (e) {
  output = {
    score:    50,
    persona:  'unknown',
    sequence: 'standard-nurture',
    reason:   'JSON parse failed — defaulted to warm track'
  };
}


# ─────────────────────────────────────────────
# SCORING REFERENCE
# ─────────────────────────────────────────────

Score Range  | Tier  | Zapier Path | AC Sequence           | Slack Alert
70 - 100     | HOT   | Path A      | high-intent-fast-track | #sales-hot-leads
40 - 69      | WARM  | Path B      | standard-nurture       | #sales-pipeline
0  - 39      | COLD  | Path C      | cold-drip              | (none)
